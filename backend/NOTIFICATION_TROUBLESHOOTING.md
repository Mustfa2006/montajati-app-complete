# ๐ง ุฏููู ุงุณุชูุดุงู ุฃุฎุทุงุก ูุธุงู ุงูุฅุดุนุงุฑุงุช

## ๐ ูุญุต ุณุฑูุน ูููุธุงู

### 1๏ธโฃ ุงุฎุชุจุงุฑ Firebase Backend
```bash
npm run test:firebase
```

### 2๏ธโฃ ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
npm run test:db
```

### 3๏ธโฃ ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุงูู
```bash
npm run test:notifications
```

### 4๏ธโฃ ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู
```bash
# ุนุฑุถ ุงููุณุชุฎุฏููู ุงููุชุงุญูู
npm run test:notification list

# ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู
npm run test:notification send +966500000000

# ุฅุฑุณุงู ุฅุนูุงู ุฌูุงุนู
npm run test:notification broadcast "ุฑุณุงูุฉ ููุฌููุน"
```

---

## ๐ฅ ูุดุงูู Firebase ุงูุดุงุฆุนุฉ

### โ ุฎุทุฃ: "Firebase Admin ุบูุฑ ูููุฃ"
**ุงูุญู:**
1. ุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ:
   ```bash
   echo $FIREBASE_SERVICE_ACCOUNT
   ```
2. ุชุฃูุฏ ูู ุตุญุฉ JSON ูู Render
3. ุดุบู: `npm run test:firebase`

### โ ุฎุทุฃ: "private_key must be a string"
**ุงูุญู:**
1. ุชุญูู ูู Private Key ูู Service Account
2. ุชุฃูุฏ ูู ูุฌูุฏ `\n` ูู ุงูููุงุถุน ุงูุตุญูุญุฉ
3. ูู Renderุ ุงุณุชุฎุฏู ูุชุบูุฑ ูุงุญุฏ `FIREBASE_SERVICE_ACCOUNT`

### โ ุฎุทุฃ: "registration-token-not-registered"
**ุงูุญู:**
1. ูุฐุง ุทุจูุนู ูุน tokens ุชุฌุฑูุจูุฉ
2. ุชุฃูุฏ ูู ุชุณุฌูู ุงููุณุชุฎุฏู ูู ุงูุชุทุจูู
3. ุชุญูู ูู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ูู ุงูุฌูุงุฒ

---

## ๐ฑ ูุดุงูู Frontend (Flutter)

### โ ุฎุทุฃ: "Firebase app not initialized"
**ุงูุญู:**
1. ุชุญูู ูู `firebase_options.dart`
2. ุชุฃูุฏ ูู ุตุญุฉ App IDs
3. ุดุบู: `flutter clean && flutter pub get`

### โ ุฎุทุฃ: "FCM Token null"
**ุงูุญู:**
1. ุชุญูู ูู ุฃุฐููุงุช ุงูุฅุดุนุงุฑุงุช
2. ุงุฎุชุจุฑ ุนูู ุฌูุงุฒ ุญูููู (ููุณ ูุญุงูู)
3. ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช

### โ ุฎุทุฃ: "Permission denied"
**ุงูุญู:**
1. ุทูุจ ุฃุฐููุงุช ุงูุฅุดุนุงุฑุงุช:
   ```dart
   await FirebaseMessaging.instance.requestPermission();
   ```
2. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู

---

## ๐ ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### โ ุฎุทุฃ: "table fcm_tokens does not exist"
**ุงูุญู:**
```bash
npm run migrate
```

### โ ุฎุทุฃ: "permission denied for table fcm_tokens"
**ุงูุญู:**
1. ุชุญูู ูู `SUPABASE_SERVICE_ROLE_KEY`
2. ุชุฃูุฏ ูู ุตุญุฉ ุงูููุชุงุญ ูู Render

### โ ุฎุทุฃ: "duplicate key value violates unique constraint"
**ุงูุญู:**
1. ูุฐุง ุทุจูุนู - ูุนูู ุฃู Token ูุณุฌู ูุณุจูุงู
2. ุงููุธุงู ูุญุฏุซ Token ุชููุงุฆูุงู

---

## ๐ง ุฎุทูุงุช ุงูุฅุตูุงุญ ุงููุชูุฏูุฉ

### 1๏ธโฃ ุฅุนุงุฏุฉ ุชุนููู Firebase
```bash
# ุญุฐู ุงูุชููุฆุฉ ุงูุณุงุจูุฉ
rm -rf node_modules/.cache
npm install

# ุงุฎุชุจุงุฑ ุฌุฏูุฏ
npm run test:firebase
```

### 2๏ธโฃ ุฅุนุงุฏุฉ ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
# ุชุดุบูู migrations
npm run migrate

# ูุญุต ุงูุฌุฏุงูู
npm run test:db
```

### 3๏ธโฃ ูุญุต ุดุงูู ูููุธุงู
```bash
# ุงุฎุชุจุงุฑ ูุงูู
npm run test:notifications

# ูุญุต logs
tail -f logs/app.log
```

---

## ๐ฑ ุงุฎุชุจุงุฑ ุนูู ุงูุฃุฌูุฒุฉ

### Android
1. ุชุฃูุฏ ูู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ูู ุงูุฅุนุฏุงุฏุงุช
2. ุชุญูู ูู Battery Optimization
3. ุงุฎุชุจุฑ ูุน ุงูุชุทุจูู ููุชูุญ ููุบูู

### iOS
1. ุชุฃูุฏ ูู ุฃุฐููุงุช ุงูุฅุดุนุงุฑุงุช
2. ุชุญูู ูู Do Not Disturb
3. ุงุฎุชุจุฑ ูุน ุงูุชุทุจูู ูู Background

---

## ๐จ ุญุงูุงุช ุงูุทูุงุฑุฆ

### ุฅุฐุง ูู ุชุตู ุฃู ุฅุดุนุงุฑุงุช:
1. **ูุญุต Firebase Console:**
   - ุชุฃูุฏ ูู ุชูุนูู Cloud Messaging
   - ุชุญูู ูู ุฅุญุตุงุฆูุงุช ุงูุฅุฑุณุงู

2. **ูุญุต Render Logs:**
   ```bash
   # ูู Render Dashboard
   View Logs -> Real-time logs
   ```

3. **ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   ```sql
   SELECT * FROM fcm_tokens WHERE is_active = true;
   ```

### ุฅุฐุง ูุตูุช ุฅุดุนุงุฑุงุช ูุชุฃุฎุฑุฉ:
1. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
2. ูุญุต Battery Optimization
3. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู

---

## ๐ ุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉ

### ูุนูููุงุช ูููุฏุฉ ููุฏุนู:
```bash
# ูุนูููุงุช ุงููุธุงู
npm run test:notifications

# ูุนูููุงุช Firebase
npm run test:firebase

# ูุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
npm run test:db

# ุฅุฑุณุงู ุชูุฑูุฑ
npm run test:notification list
```

### ูููุงุช Log ูููุฉ:
- `logs/app.log` - ุณุฌู ุงูุชุทุจูู
- `logs/firebase.log` - ุณุฌู Firebase
- `logs/notifications.log` - ุณุฌู ุงูุฅุดุนุงุฑุงุช

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

- [ ] Firebase Service Account ุตุญูุญ ูู Render
- [ ] ุฌุฏูู fcm_tokens ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] firebase_options.dart ูุญุฏุซ ุจู App IDs ุตุญูุญุฉ
- [ ] ุฃุฐููุงุช ุงูุฅุดุนุงุฑุงุช ููุนูุฉ ูู ุงูุชุทุจูู
- [ ] ุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ุญูููู
- [ ] Firebase Console ูุธูุฑ ุฅุญุตุงุฆูุงุช ุงูุฅุฑุณุงู
- [ ] Render Logs ูุง ุชุธูุฑ ุฃุฎุทุงุก Firebase
- [ ] ุงููุณุชุฎุฏู ูุณุฌู ูู ุฌุฏูู fcm_tokens

---

## ๐ฏ ูุตุงุฆุญ ููุฃุฏุงุก ุงูุฃูุซู

1. **ุชูุธูู Tokens ุงููุฏููุฉ:**
   ```sql
   DELETE FROM fcm_tokens 
   WHERE last_used_at < NOW() - INTERVAL '30 days';
   ```

2. **ูุฑุงูุจุฉ ูุนุฏู ุงููุฌุงุญ:**
   ```bash
   npm run test:notification list
   ```

3. **ุงุฎุชุจุงุฑ ุฏูุฑู:**
   ```bash
   # ุงุฎุชุจุงุฑ ูููู
   npm run test:notifications
   ```

---

*ุขุฎุฑ ุชุญุฏูุซ: 2024-12-20*
