#!/bin/bash

echo "========================================"
echo "   ุชุตุฏูุฑ ุชุทุจูู ููุชุฌุงุชู - ุงูุฅุตุฏุงุฑ ุงูููุงุฆู"
echo "========================================"
echo ""

echo "๐ฏ ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ: 3.2.0+9"
echo "๐ง ุงูุชุญุฏูุซุงุช ุงููุถุงูุฉ:"
echo "   โ ุฅุตูุงุญ ุนุฑุถ ูุนุฑู ุงููุณูุท ูู ุชูุงุตูู ุงูุทูุจ"
echo "   โ ุฅุถุงูุฉ ุฒุฑ ูุชุญ ุฑุงุจุท ุงููุณูุท ูุจุงุดุฑุฉ"
echo "   โ ุชุญุณูู ูุงุฌูุฉ ุนุฑุถ ุญุงูุฉ ุงููุณูุท"
echo "   โ ุฅุตูุงุญ ูุดููุฉ ุนุฏู ุธููุฑ QR ID"
echo "   โ ุชุญุณูู ูุธุงู ุฅุฑุณุงู ุงูุทูุจุงุช ูููุณูุท"
echo ""

echo "๐ฑ ุจุฏุก ุนูููุฉ ุงูุชุตุฏูุฑ..."
echo ""

cd frontend

echo "๐งน ุชูุธูู ุงููุดุฑูุน..."
flutter clean
if [ $? -ne 0 ]; then
    echo "โ ูุดู ูู ุชูุธูู ุงููุดุฑูุน"
    exit 1
fi

echo "๐ฆ ุชุญุฏูุซ ุงูุชุจุนูุงุช..."
flutter pub get
if [ $? -ne 0 ]; then
    echo "โ ูุดู ูู ุชุญุฏูุซ ุงูุชุจุนูุงุช"
    exit 1
fi

echo "๐ ูุญุต ุงููุดุฑูุน..."
flutter analyze
if [ $? -ne 0 ]; then
    echo "โ๏ธ ุชุญุฐูุฑ: ููุงู ูุดุงูู ูู ุงูุชุญูููุ ููู ุณูููู ุงูุชุตุฏูุฑ"
fi

echo "๐๏ธ ุจูุงุก APK ููุฅูุชุงุฌ..."
flutter build apk --release --target-platform android-arm,android-arm64,android-x64
if [ $? -ne 0 ]; then
    echo "โ ูุดู ูู ุจูุงุก APK"
    exit 1
fi

echo "๐๏ธ ุจูุงุก App Bundle ูููุดุฑ ุนูู Google Play..."
flutter build appbundle --release
if [ $? -ne 0 ]; then
    echo "โ ูุดู ูู ุจูุงุก App Bundle"
    exit 1
fi

echo ""
echo "โ ุชู ุชุตุฏูุฑ ุงูุชุทุจูู ุจูุฌุงุญ!"
echo ""
echo "๐ ูููุงุช ุงูุชุตุฏูุฑ:"
echo "   ๐ฑ APK: frontend/build/app/outputs/flutter-apk/app-release.apk"
echo "   ๐ฆ AAB: frontend/build/app/outputs/bundle/release/app-release.aab"
echo ""

echo "๐ ูุนูููุงุช ุงูุฅุตุฏุงุฑ:"
echo "   ๐ท๏ธ ุงูุฅุตุฏุงุฑ: 3.2.0+9"
echo "   ๐ ุชุงุฑูุฎ ุงูุจูุงุก: $(date)"
echo "   ๐ง ููุน ุงูุจูุงุก: Release"
echo "   ๐ฏ ุงูููุตุงุช: Android ARM, ARM64, x64"
echo ""

echo "๐ ุงูุชุทุจูู ุฌุงูุฒ ูููุดุฑ!"
echo ""

echo "๐ ุฎุทูุงุช ุงููุดุฑ:"
echo "   1. ุงุฑูุน ููู AAB ุฅูู Google Play Console"
echo "   2. ุฃู ุดุงุฑู ููู APK ูุจุงุดุฑุฉ ูุน ุงููุณุชุฎุฏููู"
echo "   3. ุชุฃูุฏ ูู ุชุญุฏูุซ ุฑูู ุงูุฅุตุฏุงุฑ ูู ุงููุชุฌุฑ"
echo ""

echo "๐ ุชู ุงูุงูุชูุงุก ูู ุนูููุฉ ุงูุชุตุฏูุฑ ุจูุฌุงุญ!"
