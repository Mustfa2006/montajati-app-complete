# ุฅุตูุงุญ ูุดููุฉ ุญุณุงุจ ุงููุจูุบ ุงููุฑุณู ูููุณูุท

## ๐ฏ ุงููุดููุฉ

ูุงู ููุงู ุฎูู ูุงุฏุญ ูู ุญุณุงุจ ุงููุจูุบ ุงููุฑุณู ูุดุฑูุฉ ุงููุณูุท ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู "ููุฏ ุงูุชูุตูู".

### ูุซุงู ุนูู ุงููุดููุฉ:
- **ุงููุจูุบ ุงูุฅุฌูุงูู ููุทูุจ**: 25,000 ุฏ.ุน (20,000 ููุชุฌุงุช + 5,000 ุชูุตูู)
- **ุงููุจูุบ ุงููุฑุณู ูููุณูุท**: 20,000 ุฏ.ุน (ูุงูุต 5,000 ุฏ.ุน)

## ๐ ุณุจุจ ุงููุดููุฉ

ูู ุฏุงูุฉ `createDefaultWaseetData` ูู ููู `backend/services/order_sync_service.js`ุ ูุงู ูุชู ุญุณุงุจ `totalPrice` ูู ูุฌููุน ุฃุณุนุงุฑ ุงูููุชุฌุงุช ููุท **ุจุฏูู ุฅุถุงูุฉ ุฑุณูู ุงูุชูุตูู**:

```javascript
// โ ุงูููุฏ ุงูุฎุงุทุฆ (ูุจู ุงูุฅุตูุงุญ)
totalPrice = orderItems.reduce((sum, item) => sum + ((item.customer_price || 0) * (item.quantity || 1)), 0);
```

ูุฐุง ูุนูู ุฃู ุงููุจูุบ ุงููุฑุณู ูููุณูุท ูุงู ููุชูุฑ ูุฑุณูู ุงูุชูุตูู.

## โ ุงูุญู

ุชู ุฅุตูุงุญ ุงูููุฏ ููุณุชุฎุฏู `order.total` ุงูุฐู ูุญุชูู ุนูู ุงููุจูุบ ุงูุฅุฌูุงูู ุงููุงูู (ุงูููุชุฌุงุช + ุฑุณูู ุงูุชูุตูู):

```javascript
// โ ุงูููุฏ ุงูุตุญูุญ (ุจุนุฏ ุงูุฅุตูุงุญ)
// ุญุณุงุจ ูุฌููุน ุงูููุชุฌุงุช ููุท (ุจุฏูู ุฑุณูู ุงูุชูุตูู)
const productsSubtotal = orderItems.reduce((sum, item) => sum + ((item.customer_price || 0) * (item.quantity || 1)), 0);

// ุงุณุชุฎุฏุงู ุงููุจูุบ ุงูุฅุฌูุงูู ุงููุงูู ูู ุงูุทูุจ (ูุดูู ุฑุณูู ุงูุชูุตูู)
totalPrice = order.total || productsSubtotal;
```

## ๐ ุงููููุงุช ุงูููุนุฏูุฉ

### 1. Backend
- `backend/services/order_sync_service.js` - ุงูุณุทุฑ 283

### 2. Frontend  
- `frontend/lib/services/order_sync_service.dart` - ุงูุณุทุฑ 419

## ๐งช ูููุงุช ุงูุงุฎุชุจุงุฑ

ุชู ุฅูุดุงุก ุนุฏุฉ ูููุงุช ูุงุฎุชุจุงุฑ ูุฅุตูุงุญ ุงููุดููุฉ:

### 1. `test_price_fix.js`
ุงุฎุชุจุงุฑ ุจุณูุท ููุญุต ุทูุจ ูุงุญุฏ ูุงูุชุฃูุฏ ูู ุตุญุฉ ุงููุจูุบ.

```bash
node test_price_fix.js
```

### 2. `fix_existing_orders_price.js`
ุฅุตูุงุญ ุฌููุน ุงูุทูุจุงุช ุงูููุฌูุฏุฉ ุงูุชู ุชุญุชูู ุนูู ูุจูุบ ุฎุงุทุฆ.

```bash
# ุฅุตูุงุญ ุฌููุน ุงูุทูุจุงุช
node fix_existing_orders_price.js

# ูุญุต ุทูุจ ูุญุฏุฏ
node fix_existing_orders_price.js check ORDER_ID
```

### 3. `test_waseet_price_integration.js`
ุงุฎุชุจุงุฑ ุดุงูู ูุฅูุดุงุก ุทูุจ ุฌุฏูุฏ ูุงูุชุฃูุฏ ูู ุตุญุฉ ุญุณุงุจ ุงููุจูุบ.

```bash
# ุงุฎุชุจุงุฑ ุดุงูู
node test_waseet_price_integration.js

# ุงุฎุชุจุงุฑ ุณุฑูุน
node test_waseet_price_integration.js quick
```

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

ุจุนุฏ ุงูุฅุตูุงุญ:

### ููุทูุจุงุช ุงูุฌุฏูุฏุฉ:
- โ ุณูุชู ุฅุฑุณุงู ุงููุจูุบ ุงูุฅุฌูุงูู ุงููุงูู (25,000 ุฏ.ุน) ูููุณูุท
- โ ูู ูุญุฏุซ ููุต ูู ุงููุจูุบ

### ููุทูุจุงุช ุงูููุฌูุฏุฉ:
- ๐ง ูููู ุฅุตูุงุญูุง ุจุงุณุชุฎุฏุงู `fix_existing_orders_price.js`
- ๐ ุณูุชู ุชุญุฏูุซ `waseet_data.totalPrice` ููุทุงุจู `order.total`

## ๐ ุฎุทูุงุช ุงูุชุทุจูู

1. **ุชุทุจูู ุงูุฅุตูุงุญ ุนูู ุงูููุฏ**:
   ```bash
   # ุชู ุชุทุจููู ุจุงููุนู ูู ุงููููุงุช ุงููุฐููุฑุฉ ุฃุนูุงู
   ```

2. **ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ**:
   ```bash
   node test_waseet_price_integration.js
   ```

3. **ุฅุตูุงุญ ุงูุทูุจุงุช ุงูููุฌูุฏุฉ**:
   ```bash
   node fix_existing_orders_price.js
   ```

4. **ุงูุชุญูู ูู ุงููุชุงุฆุฌ**:
   ```bash
   node test_price_fix.js
   ```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ูููุตุญ ุจุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุชุดุบูู ุณูุฑูุจุช ุงูุฅุตูุงุญ.

2. **ุงูุจูุฆุฉ ุงูุฅูุชุงุฌูุฉ**: ุชุฃูุฏ ูู ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ ูู ุจูุฆุฉ ุงูุชุทููุฑ ุฃููุงู.

3. **ูุฑุงูุจุฉ ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ**: ุฑุงูุจ ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ ููุชุฃูุฏ ูู ุฅุฑุณุงู ุงููุจูุบ ุงูุตุญูุญ ูููุณูุท.

## ๐ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุงููุดููุฉ ุจูุฌุงุญ! ุงูุขู ุณูุชู ุฅุฑุณุงู ุงููุจูุบ ุงูุฅุฌูุงูู ุงููุงูู (25,000 ุฏ.ุน) ูููุณูุท ุจุฏูุงู ูู ูุฌููุน ุงูููุชุฌุงุช ููุท (20,000 ุฏ.ุน).
